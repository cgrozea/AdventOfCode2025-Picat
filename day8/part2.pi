import util.
import aoc.

d(A,B)=R=>
% p((a=A,b=B)),
R=[(A[I]-B[I])**2:I in 1..3].sum.

main([F])=>
A=rim(F)
,N=A.length
,pp(A)
,H=new_min_heap(1)
,foreach(I in 1..N)
,foreach(J in 1..N,J>I)
H.heap_push([d(A[I],A[J]),I,J])
end
end
,S=[H.heap_pop():_ in 1..N*5]
,p(S)
,C={I:I in 1..N}
,M=N
,foreach(X in S,X=[_,I,J],M>1)
p(M),
if(C[I]!=C[J])
C:={cond(C[P]=C[J],C[I],C[P]):P in 1..N}
,M:=M-1
,if(M=1)
p(A[I,1]*A[J,1])
end
end
end
.
